@using Passwordless.Common.Models.Reporting
@using Passwordless.AdminConsole.Components.Shared.ApexCharts.Models
<ApexChart Id="total-credentials-count-chart" Options="_options"></ApexChart>

@code {
    [CascadingParameter]
    public required Task<IEnumerable<PeriodicCredentialReportResponse>> Data { get; set; }

    private ApexChartOptions<DateTime, int>? _options;
    
    protected override async Task OnInitializedAsync()
    {
        var data = await Data;
        _options = new()
        {
            Chart = new()
            {
                Type = ChartTypes.Line
            },
            Colors = new []{ Color.Default },
            Series = new List<Series<int>>
            {
                new()
                {
                    Name = "Users",
                    Data = data.Select(x => x.Credentials)
                }
            },
            Title = new Title
            {
                Text = "Total Credentials"
            },
            Xaxis = new()
            {
               Type = XAxisTypes.Datetime, 
               Categories = data.Select(x => x.CreatedAt)
            }
        };
    }
}