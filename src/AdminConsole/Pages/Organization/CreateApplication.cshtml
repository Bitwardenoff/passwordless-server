@page
@model CreateApplicationModel

@{
    ViewData["Title"] = "New App";
}

<Feedback name="_error" LinkUrl="@Url.PageLink("/Billing/Manage")" LinkText="Upgrade" asp-if="!Model.CanCreateApplication"
          message="You need to upgrade to a paid organization to create more applications" />
<div id="app" class="sm:w-full sm:max-w-md">
    <div class="bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10">
        <form class="space-y-6" action="" method="POST">
            <div>
                <label asp-for="Form.Name" class="form-label">Application name</label>
                <div class="mt-2">
                    <input asp-for="Form.Name" type="text" class="text-input">
                    <span asp-validation-for="Form.Name"></span>
                </div>
            </div>
    
            <div>
                <label asp-for="Form.Description" class="form-label">Description</label>
                <div class="mt-2">
                    <input type="text" asp-for="Form.Description" class="text-input">
                    <span asp-validation-for="Form.Description"></span>
                </div>
            </div>

            <div asp-if="Model.Organization.HasSubscription">
                <label asp-for="Form.Plan" class="form-label">Plan</label>
                <ul class="radio-horizontal mt-2">
                    @foreach (var availablePlan in Model.AvailablePlans)
                    {
                        <li>
                            <div>
                                <input id="@availablePlan.Id" name="Form.Plan" type="radio" value="@availablePlan.Id" checked="@(Model.Form.Plan == availablePlan.Id)">
                                <label for="@availablePlan.Id">@availablePlan.Label</label>
                            </div>
                        </li>
                    }
                </ul>
                <info-alert-box variant="ColorVariant.Info" message="The application can always be assigned to a different plan later in the 'Billing' section."></info-alert-box>
            </div>
            <input asp-if="!Model.Organization.HasSubscription" type="hidden" asp-for="Form.Plan" />

            <div>
                <div asp-validation-summary="All"></div>
                <button type="submit"
                        :disabled="availability !== 'available'"
                        class="flex w-full justify-center rounded-md bg-primary-500 py-2 px-3 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600">
                    Create
                </button>
            </div>
        </form>
    </div>
</div>
}